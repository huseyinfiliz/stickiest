(()=>{var t={n:i=>{var s=i&&i.__esModule?()=>i.default:()=>i;return t.d(s,{a:s}),s},d:(i,s)=>{for(var e in s)t.o(s,e)&&!t.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:s[e]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},i={};(()=>{"use strict";t.r(i),t.d(i,{extend:()=>s});const s=[],e=flarum.reg.get("core","forum/app");var o=t.n(e);const c=flarum.reg.get("core","common/models/Discussion");var n=t.n(c);const r=flarum.reg.get("core","common/Model");var a=t.n(r);const u=flarum.reg.get("core","forum/components/EventPost");var l=t.n(u);class y extends(l()){icon(){return o().forum.attribute("huseyinfiliz-stickiest.stickiest_icon")||"fas fa-star"}descriptionKey(){return this.attrs.post.content().stickiest?"huseyinfiliz-stickiest.forum.post_stream.discussion_stickiest_text":"huseyinfiliz-stickiest.forum.post_stream.discussion_unstickiest_text"}}flarum.reg.add("huseyinfiliz-stickiest","forum/components/DiscussionStickiestPost",y);const k=flarum.reg.get("core","common/extend"),d=flarum.reg.get("core","common/components/Badge");var f=t.n(d);function g(){(0,k.extend)(n().prototype,"badges",function(t){if(this.isStickiest()){const i=o().forum.attribute("huseyinfiliz-stickiest.stickiest_icon")||"fas fa-star";t.add("stickiest",f().component({type:"stickiest",icon:i,label:o().translator.trans("huseyinfiliz-stickiest.forum.badge.stickiest_tooltip")}),15)}this.isTagSticky()&&!this.isStickiest()&&t.add("tagSticky",f().component({type:"tagSticky",icon:"fas fa-thumbtack",label:o().translator.trans("huseyinfiliz-stickiest.forum.badge.tag_sticky_tooltip")}),12)})}flarum.reg.add("huseyinfiliz-stickiest","forum/extenders/extendDiscussionBadges",g);const h=flarum.reg.get("core","forum/utils/DiscussionControls");var p=t.n(h);const S=flarum.reg.get("core","common/components/Button");var b=t.n(S);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function T(t,i,s){return(i=function(t){var i=function(t){if("object"!=v(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=v(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(i)?i:i+""}(i))in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}const _=flarum.reg.get("core","common/components/FormModal");var z=t.n(_);const x=flarum.reg.get("core","common/components/Switch");var M=t.n(x);const I=flarum.reg.get("core","common/utils/Stream");var P=t.n(I);class w extends(z()){constructor(){super(...arguments),T(this,"isSticky",void 0),T(this,"isStickiest",void 0),T(this,"isTagSticky",void 0),T(this,"selectedTagIds",void 0)}oninit(t){var i;super.oninit(t);const s=this.attrs.discussion;this.isSticky=P()((null==(i=s.isSticky)?void 0:i.call(s))||!1),this.isStickiest=P()(s.isStickiest()||!1),this.isTagSticky=P()(s.isTagSticky()||!1);const e=s.attribute("stickyTagIds")||[];this.selectedTagIds=P()(e)}className(){return"StickyModal Modal--small"}title(){const t=this.attrs.discussion.title();return o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.title",{title:m("em",{},t)})}content(){var t;const i=this.attrs.discussion,s=(null==(t=i.tags)?void 0:t.call(i))||[],e=[];if("function"==typeof i.canSticky&&i.canSticky()&&e.push(m(".Form-group",{},[m(M(),{state:this.isSticky(),onchange:t=>{this.isSticky(t),t&&(this.isStickiest(!1),this.isTagSticky(!1))}},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.sticky_label")),m("p.helpText",{},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.sticky_help"))])),i.canStickiest()&&e.push(m(".Form-group",{},[m(M(),{state:this.isStickiest(),onchange:t=>{this.isStickiest(t),t&&this.isSticky(!1)}},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.stickiest_label")),m("p.helpText",{},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.stickiest_help"))])),i.canTagSticky()&&e.push(m(".Form-group",{},[m(M(),{state:this.isTagSticky(),onchange:t=>{this.isTagSticky(t),t&&this.isSticky(!1)}},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.tag_sticky_label")),m("p.helpText",{},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.tag_sticky_help"))])),i.canTagSticky()&&this.isTagSticky()&&s.length>0){const t=s.map(t=>{const i=Number(t.id());return m("label.checkbox",{},[m("input[type=checkbox]",{checked:this.selectedTagIds().includes(i),onchange:t=>{const s=t.target;let e=[...this.selectedTagIds()];s.checked?e.includes(i)||e.push(i):e=e.filter(t=>t!==i),this.selectedTagIds(e)}}),m("span.TagLabel",{style:{backgroundColor:t.color()||"#888"}},t.name())])});e.push(m(".Form-group",{},[m("label",{},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.select_tags")),m(".StickyModal-tags",{},t)]))}return e.push(m(".Form-group",{},m(b(),{type:"submit",className:"Button Button--primary",loading:this.loading},o().translator.trans("huseyinfiliz-stickiest.forum.sticky_modal.submit_button")))),m(".Modal-body",{},m(".Form",{},e))}onsubmit(t){t.preventDefault(),this.loading=!0;const i="function"==typeof this.attrs.discussion.canSticky,s={isStickiest:this.isStickiest(),isTagSticky:this.isTagSticky(),stickyTagIds:this.isTagSticky()?this.selectedTagIds():[]};i&&(s.isSticky=this.isSticky()&&!this.isStickiest()&&!this.isTagSticky()),this.attrs.discussion.save(s).then(()=>{this.hide(),m.redraw()}).catch(()=>{this.loading=!1,m.redraw()})}}function D(){(0,k.extend)(p(),"moderationControls",function(t,i){t.has("sticky")&&t.remove("sticky"),("function"==typeof i.canSticky&&i.canSticky()||i.canStickiest()||i.canTagSticky())&&t.add("stickiest",b().component({icon:"fas fa-thumbtack",onclick:()=>o().modal.show(w,{discussion:i})},o().translator.trans("huseyinfiliz-stickiest.forum.discussion_controls.sticky_button")),10)})}flarum.reg.add("huseyinfiliz-stickiest","forum/components/StickyModal",w),flarum.reg.add("huseyinfiliz-stickiest","forum/extenders/extendDiscussionControls",D);const j=flarum.reg.get("core","forum/components/DiscussionListItem");var F=t.n(j);const O=flarum.reg.get("core","common/utils/classList");var B=t.n(O);function C(){(0,k.extend)(F().prototype,"elementAttrs",function(t){const i=this.attrs.discussion,s="function"==typeof i.isSticky&&i.isSticky();t.className=B()(t.className,{"Stickiest-superSticky":i.isStickiest(),"Stickiest-tagSticky":i.isTagSticky()&&!i.isStickiest(),"Stickiest-sticky":s&&!i.isStickiest()&&!i.isTagSticky()})})}flarum.reg.add("huseyinfiliz-stickiest","forum/extenders/extendDiscussionListItem",C),o().initializers.add("huseyinfiliz-stickiest",()=>{o().postComponents.discussionStickiest=y,n().prototype.isStickiest=a().attribute("isStickiest"),n().prototype.isTagSticky=a().attribute("isTagSticky"),n().prototype.canStickiest=a().attribute("canStickiest"),n().prototype.canTagSticky=a().attribute("canTagSticky"),n().prototype.stickyTags=a().hasMany("stickyTags"),g(),D(),C()},-10)})(),module.exports=i})();
//# sourceMappingURL=forum.js.map